# 使用 Python 基礎映像檔
FROM python:3.10-slim

# 安裝 curl 以便下載 docker binary
RUN apt-get update && apt-get install -y curl && rm -rf /var/lib/apt/lists/* \
    && curl -fsSL https://download.docker.com/linux/static/stable/x86_64/docker-24.0.5.tgz -o docker.tgz \
    && tar xzvf docker.tgz \
    && mv docker/docker /usr/local/bin/ \
    && rm -rf docker docker.tgz

WORKDIR /app

# [New] 安裝 requests (用於執行登入腳本) 與 beautifulsoup4 (用於解析 CSRF Token，若需要)
RUN pip install --no-cache-dir mcp[cli] Fastmcp requests beautifulsoup4

COPY zap_mcp_server.py .
# 建立掛載點
RUN mkdir -p /app/data /output

CMD ["python", "zap_mcp_server.py"]