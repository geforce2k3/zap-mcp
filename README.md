# ZAP MCP Server - OWASP ZAP å¼±é»æƒæè‡ªå‹•åŒ–å·¥å…·

é€é MCP (Model Context Protocol) æ•´åˆ OWASP ZAP å¼±é»æƒæå·¥å…·ï¼Œè®“ AI åŠ©ç† (å¦‚ Claude Desktopã€Kiro) èƒ½å¤ ç›´æ¥åŸ·è¡Œç¶²ç«™å®‰å…¨æƒæä¸¦ç”¢ç”Ÿæ­£é«”ä¸­æ–‡å ±å‘Šã€‚

## åŠŸèƒ½ç‰¹è‰²

- ğŸ” **è‡ªå‹•åŒ–å¼±é»æƒæ** - æ”¯æ´ Baseline (å¿«é€Ÿ) èˆ‡ Full (å®Œæ•´æ”»æ“Š) å…©ç¨®æƒææ¨¡å¼
- ğŸ•·ï¸ **Aggressive æ¨¡å¼** - å•Ÿç”¨ AJAX Spiderã€Alpha è¦å‰‡èˆ‡é«˜å¼·åº¦æ”»æ“Š
- ğŸ“Š **æ­£é«”ä¸­æ–‡å ±å‘Š** - è‡ªå‹•ç”¢ç”Ÿ Word æ ¼å¼å ±å‘Šï¼Œå«é¢¨éšªçµ±è¨ˆåœ–è¡¨
- ğŸ³ **Docker å®¹å™¨åŒ–** - å®Œå…¨å®¹å™¨åŒ–éƒ¨ç½²ï¼Œç„¡éœ€å®‰è£é¡å¤–ä¾è³´

## ç³»çµ±éœ€æ±‚

- Docker Desktop (macOS / Windows / Linux)
- Claude Desktop æˆ– Kiro IDE (æ”¯æ´ MCP çš„ AI å®¢æˆ¶ç«¯)

## å°ˆæ¡ˆçµæ§‹

```
zap-auto/
â”œâ”€â”€ build.sh                    # ä¸€éµå»ºç½®è…³æœ¬
â”œâ”€â”€ README.md
â”œâ”€â”€ zap-mcp/
â”‚   â”œâ”€â”€ Dockerfile.mcp          # MCP Server æ˜ åƒæª”
â”‚   â””â”€â”€ zap_mcp_server.py       # MCP Server ä¸»ç¨‹å¼
â””â”€â”€ zap-reporter/
    â”œâ”€â”€ Dockerfile.reporter     # å ±å‘Šç”¢ç”Ÿå™¨æ˜ åƒæª”
    â”œâ”€â”€ requirements.txt        # Python ä¾è³´
    â””â”€â”€ zap_report_gen.py       # Word å ±å‘Šç”¢ç”Ÿå™¨
```

## å®‰è£æ­¥é©Ÿ

### 1. å»ºç½® Docker æ˜ åƒæª”

```bash
# çµ¦äºˆåŸ·è¡Œæ¬Šé™
chmod +x build.sh

# åŸ·è¡Œå»ºç½®è…³æœ¬
./build.sh
```

é€™æœƒè‡ªå‹•ï¼š
- å»ºç«‹å…±ç”¨ Docker Volume (`zap_shared_data`)
- å»ºç½® `zap-reporter` æ˜ åƒæª”
- å»ºç½® `zap-mcp-server` æ˜ åƒæª”

### 2. å»ºç«‹å ±å‘Šè¼¸å‡ºè³‡æ–™å¤¾

```bash
mkdir -p ~/Documents/zap-output
```

### 3. è¨­å®š MCP å®¢æˆ¶ç«¯

#### Claude Desktop

ç·¨è¼¯ `~/Library/Application Support/Claude/claude_desktop_config.json` (macOS) æˆ–å°æ‡‰è·¯å¾‘ï¼š

```json
{
  "mcpServers": {
    "zap-mcp": {
      "command": "docker",
      "args": [
        "run",
        "-i",
        "--rm",
        "-v", "/var/run/docker.sock:/var/run/docker.sock",
        "-v", "zap_shared_data:/app/data",
        "-v", "/Users/YOUR_USERNAME/Documents/zap-output:/output",
        "zap-mcp-server"
      ]
    }
  }
}
```

> âš ï¸ è«‹å°‡ `YOUR_USERNAME` æ›¿æ›ç‚ºä½ çš„ä½¿ç”¨è€…åç¨±

#### Kiro IDE

ç·¨è¼¯ `~/.kiro/settings/mcp.json`ï¼š

```json
{
  "mcpServers": {
    "zap-mcp": {
      "command": "docker",
      "args": [
        "run",
        "-i",
        "--rm",
        "-v", "/var/run/docker.sock:/var/run/docker.sock",
        "-v", "zap_shared_data:/app/data",
        "-v", "/Users/YOUR_USERNAME/Documents/zap-output:/output",
        "zap-mcp-server"
      ]
    }
  }
}
```

### 4. é‡å•Ÿ AI å®¢æˆ¶ç«¯

è¨­å®šå®Œæˆå¾Œï¼Œé‡æ–°å•Ÿå‹• Claude Desktop æˆ– Kiro IDE ä»¥è¼‰å…¥ MCP Serverã€‚

## ä½¿ç”¨æ–¹å¼

### å¯ç”¨å·¥å…· (MCP Tools)

| å·¥å…·åç¨± | èªªæ˜ |
|---------|------|
| `start_scan_job` | ã€ç¬¬ä¸€æ­¥ã€‘å•Ÿå‹• ZAP å¼±é»æƒæä»»å‹™ |
| `check_status_and_generate_report` | ã€ç¬¬äºŒæ­¥ã€‘æª¢æŸ¥æƒæé€²åº¦ï¼Œå®Œæˆå¾Œç”¢ç”Ÿå ±å‘Š |
| `retrieve_report` | ã€ç¬¬ä¸‰æ­¥ã€‘å°‡å ±å‘ŠåŒ¯å‡ºåˆ°æœ¬æ©Ÿè³‡æ–™å¤¾ |

### æ“ä½œæµç¨‹

#### æ­¥é©Ÿä¸€ï¼šå•Ÿå‹•æƒæ

å° AI åŠ©ç†èªªï¼š

```
è«‹å° http://example.com åŸ·è¡Œå¼±é»æƒæ
```

æˆ–æŒ‡å®šé€²éšé¸é …ï¼š

```
è«‹å° http://example.com åŸ·è¡Œ Full æƒæï¼Œä¸¦é–‹å•Ÿ Aggressive æ¨¡å¼
```

**åƒæ•¸èªªæ˜ï¼š**

| åƒæ•¸ | èªªæ˜ | é è¨­å€¼ |
|-----|------|-------|
| `target_url` | ç›®æ¨™ç¶²å€ | (å¿…å¡«) |
| `scan_type` | `baseline` (å¿«é€Ÿ) æˆ– `full` (å®Œæ•´æ”»æ“Š) | `baseline` |
| `aggressive` | æ˜¯å¦å•Ÿç”¨ç©æ¥µæ¨¡å¼ | `false` |

**æƒææ¨¡å¼æ¯”è¼ƒï¼š**

| æ¨¡å¼ | èªªæ˜ | é ä¼°æ™‚é–“ |
|-----|------|---------|
| Baseline | è¢«å‹•æƒæï¼Œä¸æœƒå°ç›®æ¨™ç™¼é€æ”»æ“Šè«‹æ±‚ | 1-5 åˆ†é˜ |
| Full | ä¸»å‹•æ”»æ“Šæƒæï¼Œæ¸¬è©¦å„ç¨®æ¼æ´ | 10-60 åˆ†é˜ |
| Full + Aggressive | å« AJAX Spiderã€Alpha è¦å‰‡ã€é«˜å¼·åº¦æ”»æ“Š | 30 åˆ†é˜ - æ•¸å°æ™‚ |

#### æ­¥é©ŸäºŒï¼šæª¢æŸ¥é€²åº¦

```
æª¢æŸ¥æƒæç‹€æ…‹
```

ç³»çµ±æœƒå›å ±ç›®å‰é€²åº¦ï¼š
- ğŸ•·ï¸ æ­£åœ¨é€²è¡Œçˆ¬èŸ²æ¢ç´¢ (Spidering)
- ğŸ‘€ æ­£åœ¨é€²è¡Œè¢«å‹•æƒæ (Passive Scanning)
- ğŸ”¥ æ­£åœ¨é€²è¡Œä¸»å‹•æ”»æ“Šæƒæ (Active Scanning)

æƒæå®Œæˆå¾Œæœƒè‡ªå‹•ç”¢ç”Ÿå ±å‘Šä¸¦é¡¯ç¤ºæ‘˜è¦ï¼š

```
âœ… ä»»å‹™å…¨éƒ¨å®Œæˆï¼
ğŸ”´ é«˜é¢¨éšª: 2 | ğŸŸ  ä¸­é¢¨éšª: 15
```

#### æ­¥é©Ÿä¸‰ï¼šåŒ¯å‡ºå ±å‘Š

```
è«‹åŒ¯å‡ºå ±å‘Š
```

å ±å‘Šæœƒå„²å­˜è‡³ï¼š
- **Word å ±å‘Š**: `~/Documents/zap-output/Scan_Report_YYYYMMDD.docx`
- **JSON åŸå§‹è³‡æ–™**: `~/Documents/zap-output/ZAP-Report.json`

## å ±å‘Šå…§å®¹

ç”¢ç”Ÿçš„ Word å ±å‘ŠåŒ…å«ï¼š

1. **å°é¢** - å…¬å¸åç¨±ã€æƒæå·¥å…·ã€æ—¥æœŸã€ç›®æ¨™ç¶²å€
2. **æƒæçµæœæ‘˜è¦** - é¢¨éšªåˆ†ä½ˆåœ“é¤…åœ–ã€çµ±è¨ˆè¡¨æ ¼
3. **å¼±é»è©³æƒ…åˆ†æ** - æ¯å€‹å¼±é»çš„ï¼š
   - å¼±é»åç¨± (ä¸­è‹±å°ç…§)
   - é¢¨éšªç­‰ç´š (ä»¥é¡è‰²æ¨™ç¤º)
   - å¼±é»æè¿°
   - å»ºè­°ä¿®å¾©æ–¹å¼

## é€²éšè¨­å®š

### è‡ªè¨‚å…¬å¸åç¨±

ç·¨è¼¯ `zap-reporter/zap_report_gen.py`ï¼Œä¿®æ”¹ `company_name` åƒæ•¸ï¼š

```python
generate_word_report(json_file, word_file, company_name="æ‚¨çš„å…¬å¸åç¨±")
```

### æ–°å¢ Logo

å°‡ `logo.png` æ”¾å…¥ Docker Volumeï¼š

```bash
docker run --rm -v zap_shared_data:/data -v $(pwd):/src alpine cp /src/logo.png /data/
```

## ç–‘é›£æ’è§£

### MCP Server ç„¡æ³•é€£ç·š

1. ç¢ºèª Docker Desktop æ­£åœ¨é‹è¡Œ
2. æª¢æŸ¥ MCP è¨­å®šæª”è·¯å¾‘æ˜¯å¦æ­£ç¢º
3. é‡æ–°å»ºç½®æ˜ åƒæª”ï¼š`./build.sh`
4. é‡å•Ÿ AI å®¢æˆ¶ç«¯

### æƒæå¤±æ•—

1. ç¢ºèªç›®æ¨™ç¶²å€å¯ä»¥æ­£å¸¸å­˜å–
2. æª¢æŸ¥ Docker å®¹å™¨ logï¼š
   ```bash
   docker logs zap-scanner-job
   ```

### å ±å‘Šç„¡æ³•åŒ¯å‡º

1. ç¢ºèªè¼¸å‡ºè³‡æ–™å¤¾å­˜åœ¨ï¼š
   ```bash
   mkdir -p ~/Documents/zap-output
   ```
2. æª¢æŸ¥ Volume å…§å®¹ï¼š
   ```bash
   docker run --rm -v zap_shared_data:/data alpine ls -la /data
   ```

## æŠ€è¡“æ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     MCP Protocol     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Claude/Kiro    â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚  zap-mcp-server  â”‚
â”‚  (AI Client)    â”‚                      â”‚  (Docker)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                  â”‚
                                                  â”‚ Docker API
                                                  â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚              Docker Engine              â”‚
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                    â”‚  â”‚ zaproxy/    â”‚  â”‚  zap-reporter   â”‚  â”‚
                    â”‚  â”‚ zap-stable  â”‚  â”‚  (Word å ±å‘Š)    â”‚  â”‚
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                    â”‚         â”‚                  â”‚           â”‚
                    â”‚         â–¼                  â–¼           â”‚
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
                    â”‚  â”‚     zap_shared_data (Volume)    â”‚   â”‚
                    â”‚  â”‚  - ZAP-Report.json              â”‚   â”‚
                    â”‚  â”‚  - Scan_Report_YYYYMMDD.docx    â”‚   â”‚
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æˆæ¬Šè²æ˜

æœ¬å°ˆæ¡ˆä½¿ç”¨ MIT Licenseã€‚

OWASP ZAP ç‚ºé–‹æºå°ˆæ¡ˆï¼Œè«‹åƒè€ƒ [OWASP ZAP å®˜æ–¹ç¶²ç«™](https://www.zaproxy.org/)ã€‚

## è²¢ç»

æ­¡è¿æäº¤ Issue æˆ– Pull Requestï¼
